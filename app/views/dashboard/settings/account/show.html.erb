<%#
  Account Settings View
  Allows artists to update their basic account information:
  - Full Name (required)
  - Location (optional)
  - Profile Photo (optional, can update existing)
%>

<div class="flex min-h-screen bg-mist">
  <!-- Persistent Sidebar -->
  <%= render 'shared/settings_sidebar', current_page: :account %>
  
  <!-- Main Content Area -->
  <div class="flex-1 p-8">
    <div class="max-w-3xl">
      <h1 class="text-3xl font-bold text-charcoal mb-8">Account Settings</h1>
      
      <%= form_with model: @artist, url: dashboard_settings_account_path, method: :patch, local: true, class: "bg-white border border-pale-celadon rounded-lg p-8" do |form| %>
        <% if @artist.errors.any? %>
          <div class="mb-6 p-4 bg-red-50 border-2 border-error rounded-lg">
            <h2 class="text-sm font-semibold text-error mb-2">
              <%= pluralize(@artist.errors.count, "error") %> prohibited this account from being saved:
            </h2>
            <ul class="list-disc list-inside text-sm text-error">
              <% @artist.errors.full_messages.each do |message| %>
                <li><%= message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <!-- Basic Information Section -->
        <div class="mb-8">
          <h2 class="text-xl font-semibold text-charcoal mb-6">Basic Information</h2>
          
          <div class="space-y-6">
            <!-- Full Name -->
            <div>
              <%= form.label :full_name, "Full Name", class: "block text-sm font-medium text-charcoal mb-2" %>
              <%= form.text_field :full_name, 
                  class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                  required: true,
                  placeholder: "Enter your full name" %>
              <p class="text-xs text-slate mt-1">This is your display name on your public profile</p>
            </div>

            <!-- Location -->
            <div>
              <%= form.label :location, "Location", class: "block text-sm font-medium text-charcoal mb-2" %>
              <%= form.text_field :location, 
                  class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                  placeholder: "City, State or Country" %>
              <p class="text-xs text-slate mt-1">Optional - Your location will be displayed on your public profile</p>
            </div>
          </div>
        </div>

        <!-- Profile Photo Section -->
        <div class="mb-8">
          <h2 class="text-xl font-semibold text-charcoal mb-6">Profile Photo</h2>
          
          <div class="space-y-4">
            <!-- Current Photo Preview -->
            <% if @artist.profile_photo.attached? %>
              <div class="flex items-center gap-4">
                <div class="w-24 h-24 rounded-lg overflow-hidden border border-pale-celadon">
                  <%= image_tag @artist.profile_photo, alt: "Current profile photo", class: "w-full h-full object-cover" %>
                </div>
                <div>
                  <p class="text-sm text-slate">Current profile photo</p>
                  <p class="text-xs text-slate">Upload a new photo to replace it</p>
                </div>
              </div>
            <% else %>
              <div class="text-center py-8 border-2 border-dashed border-pale-celadon rounded-lg bg-mist">
                <p class="text-sm text-slate mb-2">No profile photo uploaded</p>
                <p class="text-xs text-slate">Upload a photo to display on your public profile</p>
              </div>
            <% end %>

            <!-- Upload New Photo -->
            <div>
              <%= form.label :profile_photo, "Upload New Photo", class: "block text-sm font-medium text-charcoal mb-2" %>
              <%= form.file_field :profile_photo, 
                  accept: "image/jpeg,image/jpg,image/png",
                  class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                  data: { controller: "photo-upload" } %>
              <p class="text-xs text-slate mt-1">JPG or PNG, max 5MB</p>
            </div>
          </div>
        </div>

        <!-- Actions -->
        <div class="flex items-center justify-end gap-4 pt-6 border-t border-pale-celadon">
          <%= link_to "Cancel", dashboard_settings_root_path, class: "px-6 py-2 text-slate hover:text-charcoal transition-colors" %>
          <%= form.submit "Save Changes", class: "px-6 py-2 bg-celadon-dark text-white rounded-lg hover:bg-celadon-dark/90 focus:outline-none focus:ring-2 focus:ring-celadon focus:ring-offset-2 transition-colors font-medium" %>
        </div>
      <% end %>
    </div>
  </div>
</div>

