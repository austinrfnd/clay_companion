<%#
  Profile Settings View
  Allows artists to update their public profile content:
  - Biography (optional, max 2000 chars)
  - Artist Statement (optional, max 2000 chars)
  - Education (dynamic list)
  - Awards (dynamic list)
  - Social Links (website, Instagram, Facebook, other links)
  - Contact Info (email, phone)
%>

<div class="flex min-h-screen bg-mist">
  <!-- Persistent Sidebar -->
  <%= render 'shared/settings_sidebar', current_page: :profile %>
  
  <!-- Main Content Area -->
  <div class="flex-1 p-8">
    <div class="max-w-4xl">
      <h1 class="text-3xl font-bold text-charcoal mb-8">Profile Settings</h1>
      
      <%= form_with model: @artist, url: dashboard_settings_profile_path, method: :patch, local: true, class: "bg-white border border-pale-celadon rounded-lg p-8" do |form| %>
        <% if @artist.errors.any? %>
          <div class="mb-6 p-4 bg-red-50 border-2 border-error rounded-lg">
            <h2 class="text-sm font-semibold text-error mb-2">
              <%= pluralize(@artist.errors.count, "error") %> prohibited this profile from being saved:
            </h2>
            <ul class="list-disc list-inside text-sm text-error">
              <% @artist.errors.full_messages.each do |message| %>
                <li><%= message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <!-- About Content Section -->
        <div class="mb-8">
          <h2 class="text-xl font-semibold text-charcoal mb-6">About Content</h2>
          
          <div class="space-y-6">
            <!-- Biography -->
            <div>
              <%= form.label :bio, "Biography", class: "block text-sm font-medium text-charcoal mb-2" %>
              <%= form.text_area :bio, 
                  rows: 6,
                  maxlength: 2000,
                  class: "w-full px-4 py-3 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent resize-y",
                  placeholder: "Write a third-person biography about yourself and your work...",
                  data: { 
                    controller: "character-counter",
                    character_counter_max_length_value: 2000,
                    action: "input->character-counter#updateCount"
                  } %>
              <div class="flex items-center justify-between mt-1">
                <p class="text-xs text-slate">Optional - up to 2000 characters</p>
                <div class="text-xs text-slate" data-character-counter-target="counter">
                  <span data-character-counter-target="count"><%= @artist.bio&.length || 0 %></span> / 2000 characters
                </div>
              </div>
            </div>

            <!-- Artist Statement -->
            <div>
              <%= form.label :artist_statement, "Artist Statement", class: "block text-sm font-medium text-charcoal mb-2" %>
              <%= form.text_area :artist_statement, 
                  rows: 6,
                  maxlength: 2000,
                  class: "w-full px-4 py-3 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent resize-y",
                  placeholder: "Write a first-person statement about your artistic practice...",
                  data: { 
                    controller: "character-counter",
                    character_counter_max_length_value: 2000,
                    action: "input->character-counter#updateCount"
                  } %>
              <div class="flex items-center justify-between mt-1">
                <p class="text-xs text-slate">Optional - up to 2000 characters</p>
                <div class="text-xs text-slate" data-character-counter-target="counter">
                  <span data-character-counter-target="count"><%= @artist.artist_statement&.length || 0 %></span> / 2000 characters
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Education Section -->
        <div class="mb-8">
          <h2 class="text-xl font-semibold text-charcoal mb-6">Education</h2>
          <div class="space-y-4" data-controller="dynamic-list" data-dynamic-list-item-name-value="education">
            <!-- Existing education entries -->
            <% (@artist.education || []).each_with_index do |edu, index| %>
              <div class="border border-pale-celadon rounded-lg p-4" data-dynamic-list-target="item">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <%= form.fields_for :education, edu, index: index do |edu_form| %>
                    <div>
                      <%= edu_form.label :institution, "Institution", class: "block text-sm font-medium text-charcoal mb-2" %>
                      <%= edu_form.text_field :institution, 
                          class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                          placeholder: "School name" %>
                    </div>
                    <div>
                      <%= edu_form.label :degree, "Degree/Program", class: "block text-sm font-medium text-charcoal mb-2" %>
                      <%= edu_form.text_field :degree, 
                          class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                          placeholder: "Degree or program" %>
                    </div>
                    <div>
                      <%= edu_form.label :year, "Year", class: "block text-sm font-medium text-charcoal mb-2" %>
                      <%= edu_form.text_field :year, 
                          class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                          placeholder: "Year" %>
                    </div>
                  <% end %>
                </div>
                <button type="button" 
                        class="mt-3 text-sm text-error hover:text-error/80"
                        data-action="click->dynamic-list#removeItem">
                  Remove
                </button>
              </div>
            <% end %>
            
            <!-- Add Education Button -->
            <button type="button" 
                    class="px-4 py-2 border border-pale-celadon rounded-lg text-slate hover:bg-mist transition-colors"
                    data-action="click->dynamic-list#addItem">
              + Add Education
            </button>
          </div>
        </div>

        <!-- Awards Section -->
        <div class="mb-8">
          <h2 class="text-xl font-semibold text-charcoal mb-6">Awards</h2>
          <div class="space-y-4" data-controller="dynamic-list" data-dynamic-list-item-name-value="awards">
            <!-- Existing awards entries -->
            <% (@artist.awards || []).each_with_index do |award, index| %>
              <div class="border border-pale-celadon rounded-lg p-4" data-dynamic-list-target="item">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <%= form.fields_for :awards, award, index: index do |award_form| %>
                    <div>
                      <%= award_form.label :title, "Title", class: "block text-sm font-medium text-charcoal mb-2" %>
                      <%= award_form.text_field :title, 
                          class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                          placeholder: "Award title" %>
                    </div>
                    <div>
                      <%= award_form.label :organization, "Organization", class: "block text-sm font-medium text-charcoal mb-2" %>
                      <%= award_form.text_field :organization, 
                          class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                          placeholder: "Organization name" %>
                    </div>
                    <div>
                      <%= award_form.label :year, "Year", class: "block text-sm font-medium text-charcoal mb-2" %>
                      <%= award_form.text_field :year, 
                          class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                          placeholder: "Year" %>
                    </div>
                  <% end %>
                </div>
                <button type="button" 
                        class="mt-3 text-sm text-error hover:text-error/80"
                        data-action="click->dynamic-list#removeItem">
                  Remove
                </button>
              </div>
            <% end %>
            
            <!-- Add Award Button -->
            <button type="button" 
                    class="px-4 py-2 border border-pale-celadon rounded-lg text-slate hover:bg-mist transition-colors"
                    data-action="click->dynamic-list#addItem">
              + Add Award
            </button>
          </div>
        </div>

        <!-- Social Links Section -->
        <div class="mb-8">
          <h2 class="text-xl font-semibold text-charcoal mb-6">Social Links</h2>
          
          <div class="space-y-4">
            <!-- Website URL -->
            <div>
              <%= form.label :website_url, "Website URL", class: "block text-sm font-medium text-charcoal mb-2" %>
              <%= form.url_field :website_url, 
                  class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                  placeholder: "https://yourwebsite.com" %>
            </div>

            <!-- Instagram URL -->
            <div>
              <%= form.label :instagram_url, "Instagram URL", class: "block text-sm font-medium text-charcoal mb-2" %>
              <%= form.url_field :instagram_url, 
                  class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                  placeholder: "https://instagram.com/yourusername" %>
            </div>

            <!-- Facebook URL -->
            <div>
              <%= form.label :facebook_url, "Facebook URL", class: "block text-sm font-medium text-charcoal mb-2" %>
              <%= form.url_field :facebook_url, 
                  class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                  placeholder: "https://facebook.com/yourpage" %>
            </div>

            <!-- Other Links (Dynamic List) -->
            <div class="space-y-4" data-controller="dynamic-list" data-dynamic-list-item-name-value="other_links">
              <h3 class="text-lg font-semibold text-charcoal">Other Links</h3>
              <% (@artist.other_links || []).each_with_index do |link, index| %>
                <div class="border border-pale-celadon rounded-lg p-4" data-dynamic-list-target="item">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <%= form.fields_for :other_links, link, index: index do |link_form| %>
                      <div>
                        <%= link_form.label :label, "Label", class: "block text-sm font-medium text-charcoal mb-2" %>
                        <%= link_form.text_field :label, 
                            class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                            placeholder: "Link label" %>
                      </div>
                      <div>
                        <%= link_form.label :url, "URL", class: "block text-sm font-medium text-charcoal mb-2" %>
                        <%= link_form.url_field :url, 
                            class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                            placeholder: "https://example.com" %>
                      </div>
                    <% end %>
                  </div>
                  <button type="button" 
                          class="mt-3 text-sm text-error hover:text-error/80"
                          data-action="click->dynamic-list#removeItem">
                    Remove
                  </button>
                </div>
              <% end %>
              
              <!-- Add Other Link Button -->
              <button type="button" 
                      class="px-4 py-2 border border-pale-celadon rounded-lg text-slate hover:bg-mist transition-colors"
                      data-action="click->dynamic-list#addItem">
                + Add Link
              </button>
            </div>
          </div>
        </div>

        <!-- Contact Info Section -->
        <div class="mb-8">
          <h2 class="text-xl font-semibold text-charcoal mb-6">Contact Information</h2>
          
          <div class="space-y-4">
            <!-- Contact Email -->
            <div>
              <%= form.label :contact_email, "Contact Email", class: "block text-sm font-medium text-charcoal mb-2" %>
              <%= form.email_field :contact_email, 
                  class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                  placeholder: "contact@example.com" %>
              <p class="text-xs text-slate mt-1">Optional - Different from your login email if desired</p>
            </div>

            <!-- Contact Phone -->
            <div>
              <%= form.label :contact_phone, "Contact Phone", class: "block text-sm font-medium text-charcoal mb-2" %>
              <%= form.telephone_field :contact_phone, 
                  class: "w-full h-12 px-4 border border-pale-celadon rounded-lg focus:outline-none focus:ring-2 focus:ring-celadon focus:border-transparent",
                  placeholder: "+1-503-555-1234" %>
              <p class="text-xs text-slate mt-1">Optional</p>
            </div>
          </div>
        </div>

        <!-- Actions -->
        <div class="flex items-center justify-end gap-4 pt-6 border-t border-pale-celadon">
          <%= link_to "Cancel", dashboard_settings_root_path, class: "px-6 py-2 text-slate hover:text-charcoal transition-colors" %>
          <%= form.submit "Save Changes", class: "px-6 py-2 bg-celadon-dark text-white rounded-lg hover:bg-celadon-dark/90 focus:outline-none focus:ring-2 focus:ring-celadon focus:ring-offset-2 transition-colors font-medium" %>
        </div>
      <% end %>
    </div>
  </div>
</div>

